{% set contacts = this.getContacts() %}

<div class="d-flex flex-column gap-3">
    <div class="d-flex flex-wrap justify-content-between align-items-center gap-3">
        <div>
            <p class="text-secondary mb-1 small text-uppercase">Resultados</p>
            <h2 class="h5 mb-0">
                {% set count = contacts|length %}
                {{ count }} contato{% if count != 1 %}s{% endif %}
            </h2>
        </div>
        <div class="d-flex gap-2 flex-wrap">
            {% if search is not empty %}
                <span class="badge text-bg-primary">Busca: "{{ search }}"</span>
            {% endif %}
            {% if categoryId %}
                <span class="badge text-bg-info">Categoria: {{ categoryId }}</span>
            {% endif %}
            {% if this.hasGeoFilter() %}
                <span class="badge text-bg-success">Raio: {{ radiusKm }} km</span>
            {% endif %}
        </div>
    </div>

    {% if contacts is empty %}
        <div class="alert alert-warning d-flex align-items-center gap-2 mb-0">
            <span>üßê</span>
            <div>
                <strong>Nenhum contato encontrado.</strong>
                <div class="small text-secondary">Tente alterar o texto da busca, categoria ou raio.</div>
            </div>
        </div>
    {% else %}
        {% if this.sanitizedViewMode() == 'list' %}
            <div class="list-group shadow-sm rounded-3 overflow-hidden">
                {% for contact in contacts %}
                    <div class="list-group-item list-group-item-action py-3">
                        {{ component('contact_card', { contact: contact, viewMode: 'list' }) }}
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="row g-3">
                {% for contact in contacts %}
                    <div class="col-12 col-md-6 col-xl-4">
                        {{ component('contact_card', { contact: contact, viewMode: 'grid' }) }}
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endif %}
</div>
